name: Build and Test Java Application

on:
   push:
      branches:
         - main
   pull_request:
      branches:
         - main

jobs:
   build-and-test:
      runs-on: ubuntu-latest

      steps:
         # Step 1: Checkout code
         - name: Checkout code
           uses: actions/checkout@v4

         # Step 2: Set up JDK 17
         - name: Set up JDK 17
           uses: actions/setup-java@v4
           with:
              java-version: "17"
              distribution: "temurin"
              cache: maven

         # Step 3: Build and Test with Maven
         - name: Build and Test
           run: mvn clean package

         - name: Publish to GitHub Packages
           run: mvn deploy -s $GITHUB_WORKSPACE/settings.xml
           env:
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
